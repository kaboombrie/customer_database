/* creates a view of CUSTOMER and INVOICE tables */
CREATE VIEW V_CUST_INVOICES
AS SELECT CUSTOMER.CUST_NUM, CUSTOMER.CUST_LNAME, CUSTOMER.CUST_BALANCE, 
INVOICE.INV_NUM, INVOICE.INV_DATE, INVOICE.INV_AMOUNT
FROM CUSTOMER, INVOICE
WHERE CUSTOMER.CUST_NUM=INVOICE.CUST_NUM;

/* query to display V_CUST_INVOICES view */
SELECT * FROM V_CUST_INVOICES;


/* query to display sum of cust balances and sum of invoice amts */
SELECT ROUND(SUM (CUST_BALANCE),2) AS SumCustBal,
ROUND(SUM (INV_AMOUNT),2) AS SumCustInvoices
FROM V_CUST_INVOICES;


/* query to change date format in V_CUST_INVOICES view */
ALTER VIEW V_CUST_INVOICES
AS SELECT CUSTOMER.CUST_NUM, CUSTOMER.CUST_LNAME, CUSTOMER.CUST_BALANCE, 
INVOICE.INV_NUM, CONVERT(VARCHAR(8), INVOICE.INV_DATE, 10) AS INV_DATE, INVOICE.INV_AMOUNT
FROM CUSTOMER, INVOICE
WHERE CUSTOMER.CUST_NUM=INVOICE.CUST_NUM;

/* query to display V_CUST_INVOICES view */
SELECT * FROM V_CUST_INVOICES;


